<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Contributing to the SimNPH package • SimNPH</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Contributing to the SimNPH package"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">SimNPH</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/vignettes_prebuild/simple_example.html">Examples for the Usage of the SimNPH Package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/SimNPH/SimNPH/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Contributing to the SimNPH package</h1>
      <small class="dont-index">Source: <a href="https://github.com/SimNPH/SimNPH/blob/HEAD/.github/CONTRIBUTING.md" class="external-link"><code>.github/CONTRIBUTING.md</code></a></small>
    </div>

<div id="contributing-to-the-simnph-package" class="section level1">

<div class="section level2">
<h2 id="reporting-issues">Reporting Issues<a class="anchor" aria-label="anchor" href="#reporting-issues"></a></h2>
<p>Please report issues in the package, including its documentation and suggestions for enhancements in the projects <a href="https://github.com/SimNPH/SimNPH/issues" class="external-link">github issues</a>.</p>
</div>
<div class="section level2">
<h2 id="extending-simnph">Extending SimNPH<a class="anchor" aria-label="anchor" href="#extending-simnph"></a></h2>
<p>You can extend the functions of this package, either for your own use or to contribute the enhancements to the package. The most common ways of extending the package will probably be to add your own data generating mechanisms or additional analysis functions for methods you want to evaluate. For both cases the function skeletons below are a good starting point.</p>
<div class="section level3">
<h3 id="data-generating-models">Data Generating Models<a class="anchor" aria-label="anchor" href="#data-generating-models"></a></h3>
<p>Functions to generate datasets should be named beginning with <code>generate_</code> and a descriptive name of the scenario they should simulate.</p>
<p>In order to work with the SimDesign package, the function has to take the arguments <code>condition</code> and <code>fixed_objects</code>. <code>condition</code> is a one row <code>data.frame</code> that contains all parameters for the scenario that is simulated. <code>fixed_objects</code> is a list in which variables, that are the same across all secenarios are passed.</p>
<p>Generate functions should come with an <code>assumptions_...</code> function that outputs code to generate a default dataset with all the parameters relevant for the data generation model, which can be used to construct a <code>Design</code> dataset. The <code>assumptions_...</code> function should also return the dataset created by the printed code invisibly. Implement this function in the same R file as the <code>generate_...</code> function and document it in the documentation of the <code>generate_...</code> function using the roxygen tag <code>@describein</code>.</p>
<p>Here’s boilerplate for a generate and assumptions functions, you can just copy it and fill in your own code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Generate Dataset ...</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param condition condition row of Design dataset</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param fixed_objects fixed objects of Design dataset</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @details</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' Condidtion has to contain the following columns:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#'   * X ...</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#'   * Y ...</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#'   * ...</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#' For generate_x: A dataset with the columns t (time) and trt</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#' (1=treatment, 0=control), evt (event, currently TRUE for all observations)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#' @export</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#' @describeIn generate_x simulates a dataset with ...</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>generate_x <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, <span class="at">fixed_objects=</span><span class="cn">NULL</span>){</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">t=</span><span class="fu">numeric</span>(<span class="dv">0</span>), <span class="at">trt=</span><span class="fu">integer</span>(<span class="dv">0</span>), <span class="at">evt=</span><span class="fu">logical</span>(<span class="dv">0</span>))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#' Create an empty assumtions data.frame for generate_x</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return For assumptions_x: a design tibble with default values invisibly</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">#' @details assumptions_x prints the code to generate a default</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#'   design tibble for use with generate_delayed_effect and returns the</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">#'   evaluated code invisibly. This function is intended to be used to copy</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">#'   paste the code and edit the parameters.</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">#' @export</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">#' @describeIn generate_x generate default design tibble</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co">#' Design &lt;- assumptions_x()</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">#' Design</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>assumptions_delayed_effect <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  skel <span class="ot">&lt;-</span> <span class="st">"expand.grid(</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="st">  X = 1:3,</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="st">  Y = c("</span>a<span class="st">", "</span>b<span class="st">")</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(skel)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  skel <span class="sc">|&gt;</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str2expression</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">eval</span>()</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co">#' Calculate true summary statistics for scenarios with delayed treatment effect</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param Design Design data.frame for x</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param cutoff_stats Cutoff time for rmst and average hazard ratios</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param fixed_objects fixed objects not used for now</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return For true_summary_statistics_x: the design data.frame</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co">#'   passed as argument with the additional columns:</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co">#' * `rmst_trt` rmst in the treatment group</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co">#' * `median_surv_trt` median survival in the treatment group</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="co">#' * `rmst_ctrl` rmst in the control group</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="co">#' * `median_surv_ctrl` median survial in the control group</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="co">#' * `gAHR` geometric average hazard ratio</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="co">#' * `AHR` average hazard ratio</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="co">#' @export</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="co">#' @describeIn generate_x  calculate true summary statistics for ...</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>true_summary_statistics_x <span class="ot">&lt;-</span> <span class="cf">function</span>(Design, <span class="at">cutoff_stats=</span><span class="dv">10</span>, <span class="at">fixed_objects=</span><span class="cn">NULL</span>){</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  true_summary_statistics_x_rowwise <span class="ot">&lt;-</span> <span class="cf">function</span>(condition, cutoff_stats){</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">rmst_trt =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">medial_surv_trt =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">rmst_ctrl =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">median_surv_ctrl =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">gAHR =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">AHR =</span> <span class="cn">NA_real_</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    res</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  Design <span class="ot">&lt;-</span> Design <span class="sc">|&gt;</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">split</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Design)) <span class="sc">|&gt;</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="at">FUN=</span>true_summary_statistics_x_rowwise, <span class="at">cutoff_stats =</span> cutoff_stats, <span class="at">SIMPLIFY =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  Design <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, Design)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  Design</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis-functions">Analysis Functions<a class="anchor" aria-label="anchor" href="#analysis-functions"></a></h3>
<p>Analysis functions should take parameters regarding the analysis method (for example weights of a weighted logrank test) and return a function that can be used in SimDesigns <code>runSimulation</code>. To use a function as analysis function in <code>runSimulation</code> it has to take the arguments <code>condition</code>, <code>dat</code>, <code>fixed_objects</code>. Condition and fixed_objects are the same as in the <code>generate_...</code> functions. <code>dat</code> is the Dataset generated by the <code>generate_...</code> function. <code>dat</code> contains at least the columns <code>t</code>, <code>trt</code>, <code>evt</code> for time, treatment and event.</p>
<p>In order to work with the summarise functions in this package, analysis functions have to return a list. (Unfortunately vectors and data.frames are concatenated by SimDesign in a not very useful way, lists are passed on as is.)</p>
<p>If your function requires summaries that are more complex than the general functions for estimators and tests provide a summarise function in the same file as the analysis method.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Create Analyse Functions for ...</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param X</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return an analyse function that can be used in runSimulation</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="co">#'</span></span>
<span><span class="va">analyse_X</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">dat</span>, <span class="va">fixed_objects</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">result_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      A <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>      N_pat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>,</span>
<span>      N_evt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">evt</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">result_tmp</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co">#' Summarise Output from Analyse Functions for ...</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param X</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @describeIn analyse_X Summarise Output from Analyse X</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return</span></span>
<span><span class="co">#' Returns a function with the arguments:</span></span>
<span><span class="co">#'  * condition</span></span>
<span><span class="co">#'  * results</span></span>
<span><span class="co">#'  * fixed objects</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' that can be passed to create_summarise_function or to</span></span>
<span><span class="co">#' SimDesign::runSimulation and that returns a `data.frame` with the columns</span></span>
<span><span class="co">#'  * `Y` ...</span></span>
<span><span class="co">#'  * ...</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="va">summarise_x</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">name</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">condition</span>, <span class="va">results</span>, <span class="va">fixed_objects</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      <span class="st">"Y"</span><span class="op">=</span><span class="cn">NA_real_</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"name"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">name</span></span>
<span></span>
<span>  <span class="va">res</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="functions-for-censoring-and-experiment-designs">Functions for Censoring and Experiment Designs<a class="anchor" aria-label="anchor" href="#functions-for-censoring-and-experiment-designs"></a></h3>
<p>Different study setups are also implemented via functions that manipulate the simulated dataset. For example to apply administrative censoring after a fixed followup time, first a recruitment time is sampled from a uniform distribution using the function <code>recruitment_uniform</code> then the observations are censored according to their survival time, the recruitment time and the follwup time using the function <code>admin_censoring_time</code>. This can also be combined with random censoring with a fixed rate, …</p>
<p>These functions should take the simulated dataset as the first argument and further arguments at later positions so that they can be used in pipes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Modify a simulated dataset by ...</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param dat a simulated dataset</span></span>
<span><span class="co">#' @param X ...</span></span>
<span><span class="co">#' @param ...</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return</span></span>
<span><span class="co">#' Returns the dataset with ...</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="va">censoring_function_x</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span>, <span class="va">X</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dat</span><span class="op">$</span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">X</span></span>
<span>  <span class="va">dat</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="contributing-changes-to-the-package">Contributing Changes to the Package<a class="anchor" aria-label="anchor" href="#contributing-changes-to-the-package"></a></h2>
<div class="section level3">
<h3 id="project-structure">Project Structure<a class="anchor" aria-label="anchor" href="#project-structure"></a></h3>
<p>The folder structure follows the structure of a typical R package. Documentation and the NAMESPACE file are generated with roxygen, so don’t edit those files manually. Unit tests using <a href="https://cran.r-project.org/package=testthat" class="external-link">testthat</a> are in <code>tests/testthat</code> with filenames corresponding to the filenames of the functions being tested.</p>
<p>This package uses the devtools, with, testthat and roxygen2 packages to facilitate package development, all of those packages are conveniently integrated within rstudio.</p>
</div>
<div class="section level3">
<h3 id="coding-style">Coding Style<a class="anchor" aria-label="anchor" href="#coding-style"></a></h3>
<p>Please roughly keep to the <a href="https://style.tidyverse.org/" class="external-link">tidyverse styleguide</a></p>
<p>When using functions from other packages (<code>nph</code>, <code>cmprsk</code>, …) refer to them by namespace (for example <code><a href="https://rdrr.io/pkg/nph/man/rSurv_fun.html" class="external-link">nph::rSurv_fun</a></code>). In the <code>DESCRIPTION</code> file: don’t add the package under <code>Depends</code>, do add the package under <code>Suggests</code> or <code>Imports</code>.</p>
</div>
<div class="section level3">
<h3 id="documentation-and-tests">Documentation and Tests<a class="anchor" aria-label="anchor" href="#documentation-and-tests"></a></h3>
<p>When adding functions provide documentation for all functions exported in the package namespace and make sure <code>devtools::document()</code> runs without errors or warnings.</p>
<p>Please also add tests that at least test if the functions can be called without error and produce datasets with the right columns (name and datatype). To add a tests file with the correct name in the correct place use <code>usethis::use_test()</code>.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Tobias Fellinger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

